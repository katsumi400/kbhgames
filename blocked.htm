                <!DOCTYPE html>
<html lang="en">
    <head>
        <title>Blocked Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noindex">
        <style type="text/css">

            .blocked-page select:focus,
            .blocked-page a:focus,
            .blocked-page button:focus,
            .blocked-page textarea:focus,
            .blocked-page input:focus {
                outline: 2px solid #0073E6;
                outline-offset: -2px;
            }
            body:not(.user-is-tabbing) a:focus,
            body:not(.user-is-tabbing) button:focus,
            body:not(.user-is-tabbing) input:focus,
            body:not(.user-is-tabbing) select:focus,
            body:not(.user-is-tabbing) textarea:focus {
                outline: none !important;
            }
            .blocked-page input.form-control:focus {
                border: 0;
                box-shadow: none;
                border-bottom: 1px solid #66afe9;
            }
            .blocked-logo {
                width: 120px !important;
            }

            .top-logo {
                width: 100px;
                height: 70px;
                position: absolute;
            }
            .top-logo img {
                width: 100px;
                height: 70px;
                object-fit: contain;
            }

            .school-logo {
                height: auto;
            }

            .school-logo img {
                max-height: 100px;
            }

        </style>
        <!-- REL-2408 - Google Tag Manager -->
        <!-- Global site tag (gtag.js) - Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-31418916-2"></script>
        <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-31418916-2');
        </script>

        <script type="text/javascript" language="javascript" src="/js/vendor/jquery-1.11.0.min.js"></script>
        <link rel="stylesheet" href="/css/colorbox.css"/>
        <link rel="stylesheet" href="app/css/login-layouts.css">
        <link rel="stylesheet" href="app/css/blocked.css">
            <!-- Favicons -->
        <link rel="apple-touch-icon" href="/site/assets/img/favicons/favicon-180x180.png" sizes="180x180" />
        <link rel="icon" href="/site/assets/img/favicons/favicon-32x32.png" sizes="32x32" type="image/png" />
        <link rel="icon" href="/site/assets/img/favicons/favicon-16x16.png" sizes="16x16" type="image/png" />
        <link rel="icon" href="/site/assets/img/favicons/favicon-16x16.ico" />
    </head>
    <body>
    <main>
    <!--BEGIN BLOCKED TEMPLATE-->
    <div class="blocked-page businessbg">
        <!-- This overlay will appear when page is redirecting -->
        <div id="overlay" class="text-center">
            <img class="spinner" src="/app/images/redirecting-spinner.svg" alt="spinner">
             <p class="text-center redirect-text">Redirecting</p>
        </div>

        
        <!--GEO LOCATION BLOCKED-->
        
        <!-- ==========================================================================
                Blocked kids full page - html starts
        ========================================================================== -->
        <!--IF CONTACT ADMIN TWL AND LOGIN ARE OFF-->
        <div class="padding-wrapper">
            <!--IF SHOW LOGIN OR TWL OR CONTACT ADMIN IS TRUE-->
            <div class="newGrid_container shadow-container">
                <div class="row">
                                                    <div class="top-logo"> <img  src="/schoollogos/1596645813_MNPSLogo_MarkOnly_RGB_Medium.jpg" alt="Securly Logo"> </div>
                                                <h1 class="text-center heading">Looks like this page isn't allowed</h1>
                        <div class="schlblockMessage mt-0 text-center">The requested website, and/or certain content embedded on the requested web page, has been blocked due to a classification identified as inappropriate for children as outlined by requirements of the Children's Internet Protection Act (CIPA). For more information about the requirements, visit:  
https://www.fcc.gov/consumers/guides/childrens-internet-protection-act
MNPS - Securly
</div>                        
                </div>

                <div class="row">
                    <div class="col-md-7 text-center">
                        <div class="lhs-img-container ">
                            <img src="/app/images/blocking-animation.gif" alt="Blocking animation" aria-hidden="true"/>
                        </div>
                    </div>

                    <div class="col-md-5">
                        <section class="rhs-container">
                        <div id="blockDetails" class="block-details">
                                <h2 class="details-heading">Blocking details</h2>
                                <div class="regularBody"><span>URL: </span><span class="medium">kbhgames.com</span></div>
                                <div class="regularBody"><span>Reason: </span><span class="medium">Blocked by Category</span></div>
                                                                                        <button id="show-more" class="regularBody medium link-button" aria-expanded="false" aria-controls="additional-details" aria-label="Show more details about the blocked site" style="display: inline-block;">Show more</button>
                                                        <div id="additional-details">
                                <div class="more-details">
                                                                                                    <div class="details"><span>Category: </span><span>Games</span></div>
                                                                <div class="details"><span>User email: </span><span>essiem92054@mnpsk12.org</span></div>
                                <div class="details" style="padding-bottom: 24px;">
                                    <span>Policy: </span><span>Base/Default Policy</span>
                                </div>
                                <div class="details"><span>Date and time: </span><span>Tuesday, 01/20/26, 07:56AM CST</span></div>
                                <div class="details"><span>External IP: </span><span>96.4.9.71</span></div>
                                <div class="details"><span>Filtering methods: </span><span>SmartPac</span></div>
                            </div>
                            <div id="aria-kb-link" class="details" aria-label="Refer to KB article for explanation of blocking details"><span>Refer to <a id="aria-kb-link-tag" target="_blank" aria-label="KB article explaining blocking details" href="https://support.securly.com/hc/en-us/articles/214616977-How-do-I-find-out-why-a-particular-site-was-blocked-">KB article</a> for explanation of blocking details<span></div>
                                                            <button class="link-button" id="show-less" aria-expanded="true" aria-controls="additional-details" aria-label="Show less details about the blocked site" style="display:none;">Show less</button>
                                                        </div>    
                            <div class="clearfix"></div>

                        </div>

                    <!-- SHOW LESS link placed outside blockDetails div for accessibility re-ordering -->

                                            <!--IF CONTACT ADMIN TWL AND LOGIN ARE OFF , NO ACTION AVAILABLE-->
                                                            <!-- ==========================================================================
                            Blocked Kids - Right Side ends
                    ========================================================================== -->
                    </section>
                    </div>
                </div> <!-- end row -->
            </div> <!-- end newGridcontainer -->
        </div> <!-- end padding wrapping -->


            </div>
    <script>
        /* showTWL : Used for contact admin field validation purpose */
        var showTWL =  0;

        $(document).ready(function () {

            formValidate();
            var registeredDomains  = ["k12mnps.onmicrosoft.com","mnps.org","mnpsk12.org","SCHOOLS","schools.mnpsk12.local"];
            var otherText = "Other";
            if(registeredDomains){
                for (var i = 0; i < registeredDomains.length; i++) {
                    registeredDomains[i] = registeredDomains[i].toLowerCase();
                }
            }
            var EMAIL_REGEXP = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;

            $('#show-more').on('click', function (e) {
                e.preventDefault();
                $('.details').show();
                $('.more-details').slideDown();
                $('#show-less').show();
                $(this).hide();
                $(this).attr('aria-expanded', 'true');
                document.getElementById('aria-kb-link-tag').focus();
            });

            $('#show-less').on('click', function (e) {
                e.preventDefault();
                $('.more-details').slideUp();
                $('.details').hide();
                $('#show-more').show();
                $('#show-more').css('display', 'inline-block');
                $(this).hide();
                $(this).attr('aria-expanded', 'false');
                document.getElementById('show-more').focus();
            });
            $("#reasonDropdownMenu li").click(function(){
                $("#questionSelection").text($(this).text());
                $("#questionSelection").val($(this).text());
                updateReasonTextBox();
                formValidate();
                // Calling updateReasonTextBox function again for mac/ios related device
                // as weird issue coming, need to find some concrete solution for it
                // for now will keep this way
                if(/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)){
                    updateReasonTextBox();
                }
            });

            //Accessibility
            $('#questionSelection').on('keydown', function (e) {
            if (e.key === 'Enter' || e.key === ' ') {
                e.preventDefault();
                $(this).dropdown('toggle');
                setTimeout(function() {
                    var $firstItem = $('#reasonDropdownMenu li:first-child button');
                    if ($firstItem.length) $firstItem.focus();
                }, 0);
            }
            });

            $('#reasonDropdownMenu').on('keydown', 'button', function (e) {
                const $items = $('#reasonDropdownMenu button');
                const index = $items.index(this);

                switch (e.key) {
                    case 'ArrowDown':
                        e.preventDefault();
                        if (index < $items.length - 1) {
                            $items.eq(index + 1).focus();
                        } else {
                            // Loop to first item
                            $items.eq(0).focus();
                        }
                        break;

                    case 'ArrowUp':
                        e.preventDefault();
                        if (index > 0) {
                            $items.eq(index - 1).focus();
                        } else {
                            // Loop to last item
                            $items.eq($items.length - 1).focus();
                        }
                        break;
                    
                    case 'Enter':
                    case ' ': 
                        e.preventDefault();
                        $(this).click(); // trigger your existing click logic
                        $('#questionSelection').focus(); // return focus to button
                        break;

                    case 'Home':
                        e.preventDefault();
                        $items.eq(0).focus(); // focus first item
                        break;

                    case 'End':
                        e.preventDefault();
                        $items.eq($items.length - 1).focus(); // focus last item
                        break;
                }
            });
            /* REL-2199: Conact Admin Form Changes*/

            $('.askForPermissionClk').click(function() {
                if (($('.ask-btn').attr('aria-expanded')) == 'true') {
                    $('.ask-btn').attr('aria-expanded', 'false');
                } else {
                    $('.ask-btn').attr('aria-expanded', 'true');
                }
                $("#permissionForm").slideToggle('fast', function() {
                    $(".navigation-button").toggleClass("ss-navigateup ss-navigatedown");
                });
            });

            // If 'other' option selected show textbox, else remove hide textbox'
            function updateReasonTextBox() {
                var questionSelectionValue = document.getElementById("questionSelection").value;
                var otherReasonElement =  document.getElementById("otherReasonInfo");
                if(questionSelectionValue == otherText){
                    otherReasonElement.style.display= "block";
                } else {
                    otherReasonElement.value = "";
                    otherReasonElement.style.display= "none";
                }
            }
            
            /** Contact Admin Form Validation
             */
            $('#teacherEmail').on('blur', function(){
                var inputEmail = $('#teacherEmail').val();
                var domain = inputEmail.substring(inputEmail.lastIndexOf("@") + 1);
                if(EMAIL_REGEXP.test(inputEmail) && registeredDomains.indexOf(domain.toLowerCase()) == -1) {
                    $("#domainError").show();
                    $("#sendEmail").attr("disabled", true);
                }
            });

            var otherReasonInfo = document.getElementById("otherReasonInfo");
            otherReasonInfo && otherReasonInfo.addEventListener("input",function(){
                formValidate();
            });

            var teacherEmail = document.getElementById("teacherEmail");
            teacherEmail && teacherEmail.addEventListener("input",function(){
                formValidate();
            });

            var lang = "en_US";
            function startTimer(duration, display) {
                var timer = duration, minutes, seconds;
                var intervalId = setInterval(function () {
                    minutes = parseInt(timer / 60, 10);
                    seconds = parseInt(timer % 60, 10);

                    minutes = minutes < 10 ? "0" + minutes : minutes;
                    seconds = seconds < 10 ? "0" + seconds : seconds;

                    if (lang == 'es_ES') {
                        $(display).text(minutes + " minutos" + " " + seconds + " segundos");
                    } else if (lang == 'fr_CA') {
                        $(display).text(minutes + " minutes" + " " + seconds + " secondes");
                    } else {
                        $(display).text(minutes + " minutes" + " " + seconds + " seconds");
                    }

                    --timer;

                    if (timer < 0) {
                        clearInterval(intervalId);
                        window.location.reload();
                    }
                }, 1000);
            }
            var timeRemaining = 0;
            displayId = $('#banTime');
            if (timeRemaining) {
                startTimer(timeRemaining, displayId);
            }


            function formValidate(){
                var disabled = false;

                var questionSelection = $("#questionSelection");

                if (questionSelection.length && questionSelection[0]) {

                    // REASON SELECTION DROPDOWN VALIDATION
                    var selectedReason = questionSelection[0].value;
                    if (selectedReason != '') {
                        if (selectedReason == otherText) {
                            var otherReasonValue = otherReasonInfo.value;
                            if (otherReasonValue.length <= 500) {
                                disabled = false;
                            } else {
                                disabled = true;
                            }
                        } else {
                            disabled = false;
                        }
                    }
                }


                if (showTWL) {
                    // EMAIL VALIDATION
                    $("#domainError").hide();
                    if (teacherEmail) {
                        var inputEmail = teacherEmail.value;
                        if (EMAIL_REGEXP.test(inputEmail)) {
                            disabled = false;
                            var domain = inputEmail.substring(inputEmail.lastIndexOf("@") + 1);
                            if(registeredDomains.indexOf(domain.toLowerCase()) == -1) {
                                disabled = true;
                            }
                        } else {
                            disabled = true;
                        }
                    } else {
                        disabled = true;
                    }
                }
                if (disabled) {
                    $("#sendEmail").attr("disabled", true);
                } else {
                    $("#sendEmail").removeAttr("disabled");
                }
            }

            $('#sendEmail').click(function(ev){
                // Disabled send button once clicked.
                $("#sendEmail").attr("disabled", true);
                var params={};
                params['site']= $('#permissionSite').val();
                params['teacherEmail']= $('#teacherEmail').val();
                params['reason']= $('#questionSelection').val();
                params['otherReason']= $('#otherReasonInfo').val();
                params['categories'] = "Games";
                params['keyword'] = "";
                params['blockedReason'] = "Blocked by Category";
                params['policy'] = "Base%2FDefault+Policy";
                params['requesterOU'] = "-";
                params['requesterSSU'] = "-";
                params['requesterSafeSecGroupName'] = "QXp1cmUgLSBBbGwgU3R1ZGVudHMsIEluY2x1ZGVzIENoYXJ0ZXI=";
                params['requester'] = "essiem92054@mnpsk12.org";
                params['fid'] = "securly@k12mnps.onmicrosoft.com";
                params['i2n'] = "1191773280";
                params['dateTime'] = "Tuesday, 01/20/26, 07:56AM CST";
                params['externalIp'] = "96.4.9.71";
                params['ua'] = "Other";
                params['filteringMethod'] = "SmartPac";
                params['esPreference'] = "2";
                params['url'] = "kbhgames.com"
                if(params['categories']) {
                    params['categories'] = params['categories'].replace(/inappropriate adult content/i, "Pornography");
                }
                if (showTWL) {
                    sendEmail(params, 'teacher');
                } else {
                    sendEmail(params, 'admin');
                }
                ev.preventDefault();
            });
            //page redirection logic
            const isRedirectToAnotherPage =  0;
            if(isRedirectToAnotherPage == 1 ) {
                if(document.getElementById('show-more')) {
                    document.getElementById('show-more').click();
                }
                document.getElementById("overlay").style.display = "block";
                const redirectUrl =  '';
                const redirectTimeoutInMilisec =  0;
                setTimeout(function() {
                    location.href=redirectUrl;
                }, redirectTimeoutInMilisec );
            }
        });


        function sendEmail(obj, role){
            $.post( "app/api/sendtwl",obj)
                .done(function( data ) {
                    if (role == 'teacher') {
                        $("#sendEmail").attr("disabled", true);
                        $("#teacherEmail").attr("readonly", true);
                        $("#teacherEmail").attr("disabled", true);
                        $("#mailStatus").text(data.message);
                    } else {
                        $("#sendEmailAdmin").attr("disabled", true);
                        $("#mailStatus").text(data.message);
                    }
                    $("#mailFailure").hide();
                    $("#mailSuccess").show();
                })
                .fail(function(error){
                    resetFormDetails();
                    $("#sendEmail").attr("disabled", false);
                    $("#mailSuccess").hide();
                    $("#mailFailure").show();
                });
        }

        $('#sendPageScan').click(function(ev){
            $("#sendPageScanRequstedSubmitted").show();
            $("#sendPageScan").hide();
            $("#pageScanInfo").show();
            let params={};
            params['domain']= $('#psSite').val();
            params['requester'] = "essiem92054@mnpsk12.org";
            $.get( "app/api/sendps",params)
            .done(function( data ) {
            })
            .fail(function (err) {
            });
        });


        function resetFormDetails(){
            if (document.getElementById('contactAdminForm')) {
                $("#contactAdminForm")[0].reset();
            }
        }

        // keyboard-only focus
        function handleFirstTab(e) {
            if (e.keyCode === 9) { // "I am a keyboard user" key
                $('body').addClass('user-is-tabbing');
                $(window).off('keydown');
                $(window).on('mousedown', handleMouseDownOnce);
            }
        }

        function handleMouseDownOnce() {
            $('body').removeClass('user-is-tabbing');
            $(window).off('mousedown', handleMouseDownOnce);
            $(window).on('keydown', handleFirstTab);
        }

        $(window).on('keydown', handleFirstTab);

        function textAreaAdjust(element) {
            element.style.height = "1px";
            element.style.height = (25+element.scrollHeight)+"px";
        }

    </script>

        

    </main>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>
    </body>
</html>
<!--END BLOCKED TEMPLATE-->
